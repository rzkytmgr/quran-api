#!/bin/sh
echo "\n\033[33mðŸ‘® Checking your commit message right now!\033[0m"

commit_message=$(cat $1)

prefix_regex="^(feat|fix|chore|docs|style|refactor|test|perf|ci)"
suffix_regex="\(.*\):(.*)$"

if ! echo $commit_message | grep -Eq "$prefix_regex$suffix_regex"; then
  echo "\n\033[31mðŸš¨ Sorry, cannot continue the commit."
  echo "you must follow commit message rules!\033[0m\n"
  exit 1
fi

commit_prefix=$(echo $commit_message | grep -oE "$prefix_regex")

if [ $commit_prefix = 'feat' ]; then
  commit_emoji='âœ¨'
elif [ $commit_prefix = 'fix' ]; then
  commit_emoji='ðŸ›'
elif [ $commit_prefix = 'chore' ]; then
  commit_emoji='ðŸ”§'
elif [ $commit_prefix = 'docs' ]; then
  commit_emoji='ðŸ“'
elif [ $commit_prefix = 'style' ]; then
  commit_emoji='ðŸŽ¨'
elif [ $commit_prefix = 'refactor' ]; then
  commit_emoji='â™»ï¸'
elif [ $commit_prefix = 'test' ]; then
  commit_emoji='âœ…'
elif [ $commit_prefix = 'perf' ]; then
  commit_emoji='âš¡'
elif [ $commit_prefix = 'ci' ]; then
  commit_emoji='ðŸ¤–'
fi

echo "$commit_emoji $commit_message" > $1